<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kick Bot Detector PRO</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #1e1e2f;
        color: #fff;
        display: flex;
        justify-content: center;
        align-items: flex-start;
        min-height: 100vh;
        padding: 20px;
    }
    .container {
        max-width: 500px;
        width: 100%;
        background: #2a2a3e;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 0 20px rgba(0,0,0,0.5);
    }
    h1 {
        text-align: center;
        margin-bottom: 20px;
        color: #ff4f4f;
    }
    input, button {
        width: 100%;
        padding: 12px;
        margin: 8px 0;
        border-radius: 8px;
        border: none;
        font-size: 16px;
    }
    input {
        background: #1e1e2f;
        color: #fff;
    }
    button {
        background: #ff4f4f;
        color: #fff;
        cursor: pointer;
        font-weight: bold;
        transition: 0.3s;
    }
    button:hover {
        background: #ff2a2a;
    }
    .results {
        margin-top: 20px;
        display: none;
    }
    .result-bar {
        background: #555;
        border-radius: 8px;
        overflow: hidden;
        margin-bottom: 10px;
        height: 24px;
    }
    .real-bar {
        background: #4caf50;
        height: 100%;
        width: 0%;
        transition: width 0.7s;
    }
    .bot-bar {
        background: #f44336;
        height: 100%;
        width: 0%;
        transition: width 0.7s;
    }
    .label {
        display: flex;
        justify-content: space-between;
        font-size: 14px;
        margin-bottom: 5px;
    }
    .info {
        font-size: 14px;
        color: #ccc;
    }
</style>
</head>
<body>
<div class="container">
    <h1>Kick Bot Detector PRO</h1>
    <input id="channelInput" placeholder="Escribe el canal de Kick">
    <button onclick="analyze()">Analizar canal</button>
    <p class="info">*Basado en ratio chatters/viewers, estimaci칩n aproximada</p>

    <div class="results" id="results">
        <h2 id="channelName"></h2>
        <p>Total viewers: <span id="totalViewers"></span></p>

        <div class="label">
            <span>Reales</span><span id="realPercent"></span>
        </div>
        <div class="result-bar">
            <div class="real-bar" id="realBar"></div>
        </div>

        <div class="label">
            <span>Bots</span><span id="botPercent"></span>
        </div>
        <div class="result-bar">
            <div class="bot-bar" id="botBar"></div>
        </div>
    </div>
</div>

<script>
function extractChannel(input) {
    input = input.trim().toLowerCase();
    if (input.includes("kick.com")) {
        let clean = input.replace("https://", "")
                         .replace("http://", "")
                         .replace("kick.com/", "")
                         .replace("/", "");
        return clean;
    }
    return input;
}

async function analyze() {
    const input = document.getElementById("channelInput").value;
    const channel = extractChannel(input);

    if (!channel) return alert("Escribe un canal v치lido.");

    try {
        const res = await fetch(`https://kick.com/api/v2/channels/${channel}`);
        const data = await res.json();

        if (!data.livestream) {
            alert("El canal no est치 en vivo");
            return;
        }

        const total = data.livestream.viewer_count || 0;

        const chatRes = await fetch(`https://kick.com/api/v2/channels/${channel}/chatroom`);
        const chatData = await chatRes.json();
        const chatters = chatData?.chatters_count || 0;

        // L칩gica mejorada: considera que muchos viewers no escriben
        let ratio = chatters / (total || 1);
        let estimatedRealPercent = Math.round(ratio * 100 + 30); // agregamos +30% por viewers silenciosos
        if (estimatedRealPercent > 100) estimatedRealPercent = 100;
        if (estimatedRealPercent < 10) estimatedRealPercent = 10;

        const botPercent = 100 - estimatedRealPercent;

        document.getElementById("results").style.display = "block";
        document.getElementById("channelName").innerText = channel.toUpperCase();
        document.getElementById("totalViewers").innerText = total;
        document.getElementById("realPercent").innerText = estimatedRealPercent + "%";
        document.getElementById("botPercent").innerText = botPercent + "%";
        document.getElementById("realBar").style.width = estimatedRealPercent + "%";
        document.getElementById("botBar").style.width = botPercent + "%";

    } catch (e) {
        alert("Error analizando el canal.");
        console.log(e);
    }
}
</script>
</body>
</html>
